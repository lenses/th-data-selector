<link rel="import" href="../polymer/polymer.html"> 
<link rel="import" href="../core-selector/core-selector.html"> 
<!--
A Thelma component providing solution to no problem in particular.

##### Example

    <th-data-selector></th-data-selector>

@element th-data-selector
@blurb Element providing solution to no problem in particular.
@status alpha
@homepage http://nishacodes.github.io/th-data-selector
-->

<polymer-element name="th-data-selector" attributes="input dataFields output">
  <template>
    <link rel="stylesheet" href="th-data-selector.css">
    <template repeat="{{field, index in dataFields}}">
    <label for="field_selector">Select column for {{field}}: </label> 
    <core-selector id="field_selector"  valueattr="label">
        <template repeat="{{attr in inputAttributes}}">
          <div class="col" data-field="{{field}}" on-click="{{mapOutput}}" data-label="{{attr}}">{{attr}}</div>
        </template>
    </core-selector>
    </template>
  </template>

  <script>
    Polymer({
      input: [{"testlabel":"akjdals","testvalue":5},{"testlabel":"as","testvalue":10}],
      dataFields: ["label", "value", "display_value"],
      ready: function () {
        var self = this;
        self.inputAttributes = Object.keys(self.input[0]);
        self.output = self.input;
      },
      mapOutput: function(e, detail, selection){
        var self = this;
        for (var i=0;i<self.output.length; i++){
          self.output[i][selection.dataset.field] = self.output[i][selection.dataset.label];
        }
        console.log(self.output);
      }
    });
  </script>
</polymer-element>